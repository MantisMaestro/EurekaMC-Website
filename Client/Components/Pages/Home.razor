@page "/"

@inject IDataService DataService

<MudGrid Class="d-flex">
    <MudItem Class="flex-fill" lg="3" xs="12">
        <DiscordCard/>
    </MudItem>
    <MudItem Class="flex-fill" lg="6" xs="12">
        <PlayNowCard OnlineNow="_onlineToday"/>
    </MudItem>
    <MudItem Class="flex-fill" lg="3" xs="12">
        <PatreonCard/>
    </MudItem>
    <MudItem xs="12">
        <MudCarousel TData="object" Class="mud-width-full" Style="height: 640px; border-radius: 5px;" ShowArrows="true"
                     AutoCycle="true" AutoCycleTime="TimeSpan.FromSeconds(3)">
            <MudCarouselItem Transition="Transition">
                <MudPaper>
                    <MudImage Class="responsive-carousel-image" ObjectFit="ObjectFit.Cover"
                              Src="images/img1.png"></MudImage>
                </MudPaper>
            </MudCarouselItem>
            <MudCarouselItem Transition="Transition">
                <MudPaper>
                    <MudImage Class="responsive-carousel-image" ObjectFit="ObjectFit.Cover"
                              Src="images/img2.png"></MudImage>
                </MudPaper>
            </MudCarouselItem>
            <MudCarouselItem Transition="Transition">
                <MudPaper>
                    <MudImage Class="responsive-carousel-image" ObjectFit="ObjectFit.Cover"
                              Src="images/img3.jpg"></MudImage>
                </MudPaper>
            </MudCarouselItem>
        </MudCarousel>
    </MudItem>
</MudGrid>

@code {
    private const Transition Transition = MudBlazor.Transition.Fade;

    private List<Player> _onlinePlayers = [];

    private int _onlineToday;

    protected override async Task OnInitializedAsync()
    {
        _onlinePlayers = await DataService.GetOnlinePlayers();
        _onlinePlayers = _onlinePlayers.OrderByDescending(x => x.Name).ToList();
        _onlineToday = await DataService.GetTodayPlayerCount();
    }

}